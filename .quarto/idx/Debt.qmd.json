{"title":"Debt Service Discussion","markdown":{"headingText":"Debt Service Discussion","containsRefs":false,"markdown":"\n```{r warning = FALSE, message=FALSE}\n\nlibrary(tidyverse)\nlibrary(haven)\nlibrary(formatR)\nlibrary(lubridate)\nlibrary(smooth)\nlibrary(forecast)\nlibrary(scales)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(quantmod)\nlibrary(geofacet)\nlibrary(janitor)\n\n\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\n\nexp_temp <- read_csv(\"exp_temp.csv\") %>% \n  filter(agency != \"799\") \n\nrev_temp <- read_csv(\"rev_temp.csv\") %>% \n  filter(agency != \"799\")\n\n\n```\n\nDebt Service expenditures include interest payment on both short-term and long-term debt. We do not include escrow or principal payments. Bond proceeds are not considered a revenue for the state.\n\n**Methodological Change, Sept. 30 2022:** We are no longer including short term principal payments as a cost; only interest on borrowing is a cost. Pre FY22 and the FY21 correction, we did include an escrow payment and principle payments as costs but not bond proceeds as revenues. This caused expenditures to be inflated because we were essentially counting debt twice - the principle payment and whatever the money was spent on in other expenditure categories, which was incorrect.\n\n### Coding Details\n\n**Expenditure Debt Objects:**\n\n-   8811 is for principle **EXCLUDE**\n-   8813 interest **INCLUDE AS COST**\n-   8841 is for escrow payments **EXCLUDE**\n-   8800 is for all capital projects debt service (e.g. Build Illinois Bonds, Civic Center, Tollway **EXCLUDE tollway, fund 0455, in debt cost**\n\n*Note: debt principle and interest are both included in capital projects because they are combined in the data observations; bond proceeds are not considered a revenue source. Can't include capital projects interest as easily as the GO bonds.*\n\n**Expenditure Debt Obj_seq_type:**\n\n-   Exclude: principle payments: obj_seq_type == 88110008\n-   Exclude: Short term borrowing principle: obj_seq_type == 88110108\n-   Include: General Obligation Bond Interest: obj_seq_type == 88130000 & 88130008\n-   Include: Interest on short-term borrowing: 88130108\n-   Exclude: Escrow payment: obj_seq_type == 88410008\n-   Include: Build IL Bonds, capital projects principal AND interest (object ==8800)\n    -   Either filter out Tollway obj_seq_type == 88000055 or filter out fund == 0455 to remove tollway fund items from capital project debt service\n\n#### State Principal and Interest\n\nFiltering for interest on short term borrowing and GO bonds (88130008, 88130000, and 88130108) and GO bond principal amounts (88110008).\n\n-   object == 8813 is for all debt service interest but obj_seq_type is used to specify short term borrowing versus regular debt service.\n-   an Interest to Principal ratio is also calculated in the table below.\n\nLooking only at general obligation principal payments and interest payments:\n\n```{r}\n# GO bond principal and GO bond interest\n\nGObond_debt <- exp_temp %>% \n  filter(obj_seq_type == \"88110008\" |obj_seq_type == \"88130000\" | obj_seq_type == \"88130008\") %>% \n  group_by(fy, obj_seq_type) %>% \n  summarize(sum = sum(expenditure, na.rm=FALSE)) %>% \n  pivot_wider(names_from = obj_seq_type, values_from = sum) %>% \n  mutate(principal = `88110008`,\n         interest = sum(`88130008`+`88130000`, na.rm = FALSE),\n         ratio = (as.numeric(interest)/as.numeric(principal)))\n\nGObond_debt %>% \n  select(principal, interest, ratio) %>%\n  mutate(across(principal:interest, ~format(., big.mark= \",\", scientific = F)))\n\n# GObond_debt %>% ggplot() + \n#   geom_line(aes(x=fy, y=principal, color = \"Principal\"))+ \n#   geom_line(aes(x=fy, y=interest, color = \"Interest\")) + \n#   labs(title = \"General Obligation principal and interest payments\")\n\n\n\nGObond_debt %>% \n  ggplot() +   \n    geom_col(aes(x=fy, y=interest/1000000, fill = \"Interest\")) + \n    geom_col(aes(x=fy, y=principal/1000000, fill = \"Principal\"))+ \n    labs(title = \"Debt Service\", \n         subtitle = \"General Obligation Principal and Interest Payments\")\n\n```\n\nLooking only at short term borrowing principal and interest payments\n\n```{r}\n# short term borrowing, first observation is in 2004?\n\nshort_debt <- exp_temp %>% \n  filter(obj_seq_type == 88110108 |obj_seq_type == 88130108) %>% \n  group_by(fy, obj_seq_type) %>% \n  summarize(sum = sum(expenditure, na.rm=FALSE)) %>% \n  pivot_wider(names_from = obj_seq_type, values_from = sum) %>% \n  mutate(principal = `88110108`,\n         interest = `88130108`,\n         ratio = (as.numeric(interest)/as.numeric(principal)))\n\nshort_debt %>% select(principal, interest, ratio) %>%\n  mutate(across(principal:interest, ~format(., big.mark= \",\",  scientific = F)))\n\nshort_debt %>% ggplot() + \n  geom_col(aes(x=fy, y=principal/1000000000, fill = \"Principal\"))+ \n  geom_col(aes(x=fy, y=interest/1000000000, fill = \"Interest\")) + \n  labs(title = \"Debt Service\", subtitle = \"Short Term Borrowing: Principal and Interest Payments\", y=\"Billions of Dollars\")\n```\n\nWhen including short term borrowing and normal debt service, the debt ratio seems more normal and the total interest and principal payments over the years are smoothed out.\n\nFor additional context, here is a very simple graph of all bond proceeds. Bond proceeds are not considered a revenue source in the Fiscal Futures model. We do not dive into the different types of proceeds but that could be an interesting topic by itself.\n\n```{r}\nrev_temp %>% \n  filter(rev_type == \"72\")\n\nbond_proceeds <- rev_temp %>% \n  filter(rev_type == \"72\") %>% #bond proceeds\n#  filter(agency == \"370\" & source == \"0571\") %>%     \n  group_by(fy, fund_cat_name.y) %>% \n  summarize(sum = sum(receipts/1000000000, na.rm=FALSE))\n\nbond_proceeds %>% ggplot() + \n  geom_line(aes(x=fy, y=sum, color=fund_cat_name.y)) + \n  labs(title = \"Bond Proceeds, Revenue Type = 72\", y=\"Billions of Dollars\")\n```\n\n#### \n\n-   Tollway expenditure = Debt service costs + maintenance & operation costs\n\nPrincipal and interest amounts calculated for the state exclude the Illinois Tollway debt service and debt service for capital projects (mostly because principal and interest are included as one item in the data). Capital projects include the IL Civic Center and Build Illinois Bonds. Tollway principal and interest has been dropped from the State's total Debt Service expenditure but it is included in the Illinois Tollway Expenditure cost.\n\nCapital projects debt service is examined below:\n\n```{r}\ncapitalprojects <- exp_temp %>% \n  filter(object == \"8800\" & fund != \"0455\") # capital debt service except tollway\n\nall_debt <- exp_temp %>%     # all debt except tollway\n  filter(fund != \"0455\" & (object == \"8811\" |object == \"8813\" | object == \"8800\") )%>% \n  group_by(fy, object) %>% \n  summarize(sum = sum(expenditure, na.rm=TRUE)) %>% \n  pivot_wider(names_from = object, values_from = sum) %>% \n  mutate(principal = `8811`,\n         interest = `8813`,\n         CapitalProjects = `8800`,\n         ratio = (as.numeric(interest)/as.numeric(principal)))\n\nall_debt %>% \n  select(principal, interest, CapitalProjects, ratio) %>%\n  mutate(across(principal:CapitalProjects, ~format(., big.mark= \",\", scientific = F)))\n\nall_debt %>% \n  ggplot() + \n    geom_line(aes(x=fy, y=principal/1000000, color = \"Principal\"))+ \n    geom_line(aes(x=fy, y=interest/1000000, color = \"Interest\"))+\n    geom_line(aes(x=fy, y = CapitalProjects / 1000000, color = \"Capital Projects\"))+\n    labs(y = \"Debt ($Millions)\",\n         title = \"Principal and Interest payments\", \n         subtitle = \"Principal and interest from short term borrowing and GO Bonds debt service\", \n         caption = \"Capital projects does not include Illinois tollway debt service.\n  \n         Capital projects data include interest and principal values as one value and cannot be sepearated.\")\n\n\n\n```\n\n#### Tollway Debt, Revenue, and Expenditures\n\nA note on what is considered Transportation vs. Tollway vs. Capital Projects:\n\n-   Transportation is made up of the road fund (0011) , capital administrative costs, and maintenance costs for the agency=494, Department of Transportation.\n-   Tollway expenditures include maintenance and operation, principle and interest payments occurring from fund 0455 and agency = 577.\n-   Capital improvement has a lot of projects that use bond financed funds for schools, sports facilities, etc. Agencies 511, 554, 574, and 598 are coded together as group 946, capital improvement (Capital Development Board, Sports Facilities Development Authority, Metro Pier and Exposition Authority, and Upper River Development Authority which is no longer used). IOC uses object 8800.\n\n*Coding Notes: Tollway agency expenditures = SAME as filtering by fund == 0455*\n\n```{r tollway}\n\n# exp_temp %>% \n#   filter(fund == \"0455\") %>%       # tollway fund\n#   group_by(fy) %>% \n#   summarize(sum = sum(expenditure)) %>% \n#   arrange(-fy)\n\ntollway <- exp_temp %>% \n  filter(fund == \"0455\") #all tollway expenditures\n\ntollway\n\ntollway_exp <- exp_temp %>% \n  filter(fund == \"0455\") %>% \n  group_by(fy) %>% \n  summarize(expenditure = sum(expenditure))\n\n\n\ncapitalproject_debtservice <- exp_temp %>%\n  filter(object == \"8800\") # ALL Capital projects debt service including tollway\n\n# look at Illinois tollway bond proceeds and debt service: \nrev_temp %>% filter(fund == \"0455\") # examine revenue to fund 0455\n\n\nrev_temp %>% \n  filter(fund == \"0455\") %>% \n  group_by(fy) %>% \n  summarize(sum = sum(receipts)) %>% \n  arrange(-fy)\n\nalltollway <- rev_temp %>% \n  filter(fund == \"0455\" & source != \"0571\") %>% \n  group_by(fy) %>% \n  summarize(sum = sum(receipts, na.rm = TRUE))\n\n\n\n# tollway bond proceeds\ntollway_bondproc <- rev_temp %>% \n  filter(fund == \"0455\" & source == \"0571\" ) %>% \n  group_by(fy) %>% \n  summarize(sum = sum(receipts, na.rm = TRUE))\n\n#alltollway %>%  ggplot() + geom_line(aes(x=fy, y=sum)) + labs(title = \"Fund 0455 - All Tollway Revenue\", caption = \"Data from IOC Revenue Files. Fund 0455 is the IL State Tollway Revenue\") \n\n#tollway_bondproc %>% ggplot() + geom_line(aes(x=fy, y=sum)) + labs(title = \"Fund 0455 - Tollway Revenue: Tollway Bond Proceeds\", caption = \"Data from IOC Revenue Files. Fund 0455 is the IL State Tollway Revenue\")\n\n  \n\n#ggplot() + geom_line(data=tollway_bondproc, aes(x=fy, y=sum)) + labs(title = \"Fund 0455 - Tollway Revenue: Tollway Bond Proceeds\", caption = \"Data from IOC Revenue Files. Fund 0455 is the IL State Tollway Revenue\")\n\n#tollwaydebt %>% ggplot() + geom_line(aes(x=fy, y=sum)) + labs(title = \"Tollway Debt Service\", caption = \"Debt service includes principal and interest for the Illinois Tollway. Object = 8800 and fund = 0455\")\n\n#tollway debt principal and interest\n\ntollwaydebt <- exp_temp %>%\n  filter(object == \"8800\" & fund == \"0455\") %>% \n  group_by(fy) %>% \n  summarize(sum=sum(expenditure)) \n\n\n## Tollway agency 577 expenditures = SAME as filtering by tollway fund == 0455 ##\n\n# tollway<-exp_temp %>% filter(agency == \"557\")\n\n# exp_temp %>% filter(agency == \"557\") %>% group_by(fy) %>% summarize(sum = sum(expenditure)) %>% arrange(-fy)\n\n\n\nggplot()+\n  geom_col(data=tollway_bondproc, aes(x=fy, y=sum)) +\n  geom_line(data= tollwaydebt, aes(x=fy, y = sum, color = 'Debt Service'))+ \n  geom_line(data= tollway_exp, aes(x=fy, y = expenditure, color = 'Tollway Expenditures'))+ \n  geom_line(data= alltollway, aes(x=fy, y = sum, color = \"Tollway Revenue\"))+ \n  scale_color_manual(values = c(\n    'Bond Proceeds' = 'darkgray',\n    'Debt Service' = 'red',\n    'Tollway Expenditures' = 'orange',\n    'Tollway Revenue' = 'light green')) +\n  labs(title=\"Tollway bond procreeds, debt service, revenue, and expenditures.\", \n       caption = \"Tollway revenue + bond proceeds should be roughly equal to tollway expenditures + debt service.\", \n       y = \"Dollars\")\n\n```\n\n#### \n\n```{r}\nall_debt %>% \n  ggplot() + \n    geom_line(aes(x=fy, y=principal/1000000, color = \"Principal\"))+ \n    geom_line(aes(x=fy, y=interest/1000000, color = \"Interest\"))+\n    geom_line(aes(x=fy, y = CapitalProjects / 1000000, color = \"Capital Projects Debt Service\"))+\n    geom_line(data = tollwaydebt, aes( x=fy, y=sum/1000000, color = \"Tollway Debt Service\"))+\n    labs(y = \"Debt ($Millions)\", title = \"Short term borrowing and GO Bonds\",\n         subtitle = \"Principal and Interest payments\", caption = \"Capital projects does not include Illinois tollway debt service.\") \n\nall_debt %>% \n  ggplot() + \n    geom_line(aes(x=fy, y=(principal+interest)/1000000, color = \"Principal & Interest\"))+ \n    #geom_line(aes(x=fy, y=interest/1000000, color = \"Interest\"))+\n    geom_line(aes(x=fy, y = CapitalProjects / 1000000, color = \"Capital Projects Debt Service\"))+\n    geom_line(data = tollwaydebt, aes( x=fy, y=sum/1000000, color = \"Tollway Debt Service\"))+\n    labs(y = \"Debt ($Millions)\", title = \"Illinois Debt Service Expenditures: Short term borrowing and GO Bonds\",\n         subtitle = \"Principal and Interest payments\", caption = \"Capital projects does not include Illinois tollway debt service.\") \n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"paged","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"Debt.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.269","editor":"visual","theme":"darkly"},"extensions":{"book":{"multiFile":true}}}}}