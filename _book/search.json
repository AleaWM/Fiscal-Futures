[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Fiscal-Future-Topics",
    "section": "",
    "text": "Background Info\nNormally, when your receive the new fiscal year files from the Comptrollers office, you will need to change the variable names so that they are consistent with past years. This is an example of reading in the new file and changing the variable names. They seem to change almost every year in the file received from the FOIA so if the code breaks here, check to make sure that the columns you are trying to rename exist and are spelled correctly! Once variables are the same, you will want to save the file as a csv file in its Revenue/Expenditure file and bind all past years and the current year together in one dataframe.\nThe code chunk below takes the .dta files for all fiscal years before FY 2022 and binds them together. Variable names were manually changed by past researchers so that they were consistent across years.\nFor FY 2023 and after, .dta files can be avoided entirely and .csv or excel files will be used. All files before this year had been saved and passed on as .dta files for Stata code before the transition to R in Fall 2022. For years after fy22: add line of code to bind csv files after binding the dta files together. Variable names must identical to merge files together.\nCode below reads in the csv files created in chunks above (allrevfiles.csv and allrexpfiles.csv). These files contain all years of data combined into one file BEFORE any recoding is done. Do not use this file for summing categories because it is just an inbetween step before recoding revenue and expenditure categories."
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "This is a book created from markdown and executable code.\nSee Knuth (1984) for additional discussion of literate programming.\n\n1 + 1\n\n[1] 2\n\n\n\n\n\n\nKnuth, Donald E. 1984. “Literate Programming.” Comput. J. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97."
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "2  Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Knuth, Donald E. 1984. “Literate Programming.” Comput.\nJ. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97."
  },
  {
    "objectID": "Pensions.html",
    "href": "Pensions.html",
    "title": "3  Pensions",
    "section": "",
    "text": "library(tidyverse)\nlibrary(haven)\nlibrary(formatR)\nlibrary(lubridate)\nlibrary(smooth)\nlibrary(forecast)\nlibrary(scales)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(quantmod)\nlibrary(geofacet)\nlibrary(janitor)\n\n\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, cache = TRUE, eval=FALSE)\n\nFor yearly expenditure calculations, the state contributions to the pension funds (object = 4431) should be the expenditure included for pensions. If trying to look at the bigger fiscal health picture and include unfunded liabilities and in/out flows, then items like purchase of investments and POB spikes in trends that occurred from policy changes should be analyzed and discussed in a separate section. Again, State contributions TO the pension funds are the expenditures BUT an additional graph/discussion on the employer contributions, employee contributions, and benefits paid out should be included and considered for additional context on Illinois' situation.\nPension expenditures referenced in the analysis are based on state payments to the following pension systems:\n• Teachers Retirement System (TRS)\n- New POB bond in 2019: Accelerated Bond Fund paid benefits in advance as lump sum\n• State Employee Retirement System (SERS)\n• State University Retirement System (SURS)\n• Judges Retirement System (JRS)\n• General Assembly Retirement System (GARS)\nAdditional context:\nFor the $10 billion in 2004, they borrowed money and invested it in pension portfolio and hoped that the returns would be greater than the interest on the debt. If returns>interest, then they increased the pension funds and it was a good idea. Otherwise a short term band-aid causes even more problems later. This added a significant amount to the unfunded pension liabilities. In 2010 and 2011, POBs served as a type of general borrowing for the state by borrowing against what was owed to the pension systems and using that revenue that should have funded pensions to instead subsidize the cost of providing core services. Illinois borrowed money (POBs) and used it to pay for government services. A temporary way to fill a budget gap for that 2010 that then costs more in the long run due to increased unfunded liabilities and interest on the borrowed money. - \"Basket Case\" by Dye 2015\nIn 2019 lawmakers offered a pension buyout plan where members could opt-out of their future benefits for a lump sum. However, few people participated in the buyout plan and very little savings have occurred so far. The buyout plan has been extended to 2026 in hopes that more people participate in it. Description of Pension Obligation Acceleration Bond at this link. Proceeds of bonds go into pension obligation acceleration fund (which are not included as a revenue source) and the fund is only used to make accelerated pension benefit payments. The pension stabilization fund (0319) is money put into the pension funds to help pay for unfunded liabilities from past poor budgeting decisions.\nData coding details\n\nState pension contributions are largely captured with object=4431. (These are the State expenditures included in analysis)\n\nincludes 8 billion payment in 2004 that creates large peak in expenditure graphs\n\nObject 4431 does not capture recent pension stabilization fund which is fund = 0319, object = 1900 and has $300 million investment in FY2022.\n\nFund=0475 is the Municipal Retirement Fund - Not included because state just helps collect and disperse local pension funds. IMRF is most funded pension fund in Illinois. Fund ends in 2015. All were considered purchase of investments.\nIOC objects 1160-1165 are for all retirement expenditures for employers. These are not included in the analysis.\nSome expenditures with object=4430 (benefits paid to retirees) were paid for with Pension obligation bond funds (fund == 0825).\nIn past years, some POB funded expenditures were moved to revenue side. Code logic was unclear. We are no longer doing this as of FY2021.\nOther types of pension expenditures to consider when looking at pension funds: Pension obligation acceleration bond, state pension obligation bond reimbursements, pension pickup, accelerated pension buy-out (bond financed funds)\n\nOther items to be aware of that may contain useful pension context:\n\nobject = 1298 is for Purchase of Investments and is excluded from analysis. In past analyses, there were a couple of exceptions during 2010 and 2011.\n\nPurchase of Investments captures the pension obligation bonds issued in 2010-2011.\n\n\nobject = 1900 for pension stabilization is under lump sums\n\nobject = 1167 and 1168 is for Employer pension contributions but is not used by IOC yet as of FY2022.\n\nobject 4900 is awards and grants lump sum\n\nEmployer contributions for pensions are excluded from analysis to avoid double counting the cost of pensions. Expenditures with object 4430 for pensions, benefits, and annuities appears in items from funds 0473, 0477, 0479, 0481, (TRS, JRS, SERS, GARS), 0755, 0786, 0787, 0788, 0789, 0799 (deferred compensation plan, GAR excess benefit, JRS excess benefit, SER excess benefit, TRS excess benefit, state university retirement system) are NOT included in the analysis. All are coded with in_ff=0 in the fund_ab_in.xlsx file of funds.\nMost of these funds were found by either using CTRL-F with pension related words or scrowllin through code options on the comptroller's website.\n\n# check what is being included in pensions\n\n# funds related to pension contributions\npension_funds <- c(\"0472\", \"0473\", \"0477\", \"0479\", \"0481\", \"0755\", \"0786\", \"0787\", \"0788\", \"0789\", \"0799\")\n\npension_check <- exp_temp %>% \n  mutate(pension = case_when( \n # object == \"4430\" & fund == \"0825\" ~ \"Object 4430 - Pension Buyout/Benefits Paid Early\",\n    (object==\"4430\") ~ \"Object 4430 - Benefits Paid to Employees; EXCLUDED\", # pensions, annuities, benefits\n    (object==\"4431\") ~ \"Object 4431 - State Contributions; INCLUDED\", # 4431 = state payments into pension fund\n        (obj_seq_type > \"11590000\" & obj_seq_type < \"11660000\")  ~ \"Object 1160-1165 Employer Contributions to Pension Fund; EXCLUDED\",\n    # objects 1159 to 1166 are all considered Retirement by Comptroller \n    \n            TRUE ~ \"0\")) %>%  # All other observations coded as 0 for non-pension items\n  \n  # recodes specific instances of code anomalies from past years:\n  mutate(pension = case_when(\n    (object==\"1298\" & fund %in% pension_funds ) ~ \"Object 1298 - Purchase of Investments; DROPPED\", \n\n    \n      # pension stabilization fund in 2022 \n # object == \"1900\" & fund == \"0319\" ~ \"Fund 0319-Pension Stabilization\", \n    object == \"1900\" & fund %in% pension_funds ~ \"Fund 0319 - Pension Stabilization\", \n\n  \n  object == \"4900\" & fund %in% pension_funds ~ \"Object 4900 - Awards/Grants; Weird 2010-2011 values\",\n  \n    TRUE ~ as.character(pension)) ) %>% \n  filter(pension != \"0\" )\n\npension_check %>% group_by(fy, pension) %>% \n  summarize(expenditure = sum(expenditure, na.rm = TRUE)) %>%\n  ggplot(aes(x=fy, y = expenditure, color = pension)) + \n  geom_line() + \n\n  labs (title = \"Pension Fund Payments In and Retirement Benefits Out\", \n  caption = \"Object 4430 is retirement benefits paid to employees. \n  Object 4431 includes state payments INTO pension Fund.\n  Object 1998 is excluded except for years 2010 and 2011 due to POBs.\")+\n    theme(legend.position = \"bottom\")+\n  guides(color = guide_legend(nrow=3))\n\nPension contributions from employees and employers are not included as revenue sources but are useful for understanding the money going into the funds and the money flowing out of the funds. Identifying and graphing employee and employer contributions, as well as benefits paid to retired employees and state contributions was important for checking the items that should and should not be included in the analysis.\n\n\n\n# # contributions and benefits paid comparison\n# ggplot()+\n#   geom_line(data=employee_contributions, aes(x=fy, y=contributions), color=\" light green\") +\n#     geom_line(data=employer_contributions, aes(x=fy, y=contributions), color=\"orange\") +\n# \n#   geom_line(data= state_contrib, aes(x=fy, y = expenditure), color = \"red\")+ \n# \n#   geom_line(data= benefits_paid, aes(x=fy, y = expenditure), color = \"dark blue\")+ \n#   labs(title=\"Pension fund inflows and outflows\", \n#        caption = \"Blue: object = 4430 for benefits paid out of funds, \n#       red:  object = 4431 for state contributions into pension fund, \n#     neon  green: employee contributions into the fund,\n#      orange: employer contributions into the fund.\", y = \"Dollars\")\n\npension_picture %>% group_by(fy, pension) %>% \n  summarize(expenditure = sum(expenditure, na.rm = TRUE)) %>%\n  ggplot(aes(x=fy, y = expenditure, color = pension)) + \n  geom_line() + \n  geom_line(data=employee_contributions, aes(x=fy, y=contributions), color=\"green\") +\n    geom_line(data=employer_contributions, aes(x=fy, y=contributions), color=\"orange\") +\n  labs (title = \"Pension Fund Payments In and Retirement Benefits Out\", \n  caption = \"Neon green - employee contributions INTO the fund. \n  Orange - employer contributions INTO the fund.\")+\n    theme(legend.position = \"bottom\", legend.title = element_blank())"
  },
  {
    "objectID": "Debt.html",
    "href": "Debt.html",
    "title": "2  Debt Service Discussion",
    "section": "",
    "text": "library(tidyverse)\nlibrary(haven)\nlibrary(formatR)\nlibrary(lubridate)\nlibrary(smooth)\nlibrary(forecast)\nlibrary(scales)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(quantmod)\nlibrary(geofacet)\nlibrary(janitor)\n\n\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, cache = TRUE, eval=FALSE)\n\nDebt Service expenditures include interest payment on both short-term and long-term debt. We do not include escrow or principal payments.\n**Decision from Sept 30 2022:** We are no longer including short term principal payments as a cost; only interest on borrowing is a cost. Pre FY22 and the FY21 correction, we did include an escrow payment and principle payments as costs but not bond proceeds as revenues. This caused expenditures to be inflated because we were essentially counting debt twice - the principle payment and whatever the money was spent on in other expenditure categories, which was incorrect.\nObjects:\n8813 interest **INCLUDE AS COST**\n8811 is for principle **EXCLUDE from aggregate debt expenditure**\n8841 is for escrow payments **EXCLUDE from aggregate debt expenditure**\n8800 is for capital projects debt service (e.g. Build Illinois Bonds, Civic Center, Tollway **EXCLUDE tollway in debt cost**\n\nNote: debt principle and interest are both included in capital projects because they are combined in the data observations; bond proceeds are not considered a revenue source. Can’t include capital projects interest as easily as the GO bonds.\n\n**Obj_seq_type:**\n- Exclude: Bond principle payments: obj_seq_type == 88110008\n- Exclude: Short term borrowing principle: obj_seq_type == 88110108\n- Include: General Obligation Bond Interest: obj_seq_type == 88130000 & 88130008\n- Include: Interest on short-term borrowing: 88130108\n- Exclude: Escrow payment == 88410008\n- Include: Build IL Bonds, capital projects principal AND interest\n\nTollway is obj_seq_type == 88000055, filter out fund == 0455 to remove tollway\nfund == 0455 is the IL State Toll Highway fund, items mostly for operations and maintenance\n\n\n2.0.0.1 Tollway Debt, Revenue, and Expenditures\n\ntollway <- exp_temp %>% filter(fund == \"0455\") #all tollway expenditures\n\ncapitalproject_debtservice <- exp_temp %>%filter(object == \"8800\") # ALL Capital projects debt service\n\n# look at Illinois tollway bond proceeds and debt service: \n\n# rev_temp %>% filter(fund == \"0455\") # examine items in fund 0455\n\n#exp_temp %>% filter(fund == \"0455\") %>% group_by(fy) %>% summarize(sum = sum(expenditure)) %>% arrange(-fy)\n\ntollway\n\n#rev_temp %>% filter(fund == \"0455\") %>% group_by(fy) %>% summarize(sum = sum(receipts)) %>% arrange(-fy)\n\ntollway_exp <- exp_temp %>% filter(fund == \"0455\") %>% group_by(fy) %>% summarize(expenditure = sum(expenditure))\n\n                                                                                                    #tollway_exp %>% ggplot() + geom_line(aes(x=fy, y=expenditure)) + labs(title = \"Fund 0455 from Expenditure: All Tollway Expenditures\", caption = \"Data from IOC Expenditure Files. Fund 0455 is the IL State Tollway\")\n\n# all tollway revenues, not just bond proceeds\n\nalltollway<-rev_temp %>% filter(fund == \"0455\" & source != \"0571\") %>% group_by(fy) %>% summarize(sum = sum(receipts, na.rm = TRUE))\n\n# tollway bond proceeds\n\ntollway_bondproc <- rev_temp %>% filter(fund == \"0455\" & source == \"0571\" ) %>% group_by(fy) %>% summarize(sum = sum(receipts, na.rm = TRUE))\n\n#alltollway %>%  ggplot() + geom_line(aes(x=fy, y=sum)) + labs(title = \"Fund 0455 - All Tollway Revenue\", caption = \"Data from IOC Revenue Files. Fund 0455 is the IL State Tollway Revenue\") \n\n#tollway_bondproc %>% ggplot() + geom_line(aes(x=fy, y=sum)) + labs(title = \"Fund 0455 - Tollway Revenue: Tollway Bond Proceeds\", caption = \"Data from IOC Revenue Files. Fund 0455 is the IL State Tollway Revenue\")\n\n  \n\n#ggplot() + geom_line(data=tollway_bondproc, aes(x=fy, y=sum)) + labs(title = \"Fund 0455 - Tollway Revenue: Tollway Bond Proceeds\", caption = \"Data from IOC Revenue Files. Fund 0455 is the IL State Tollway Revenue\")\n\n#tollwaydebt %>% ggplot() + geom_line(aes(x=fy, y=sum)) + labs(title = \"Tollway Debt Service\", caption = \"Debt service includes principal and interest for the Illinois Tollway. Object = 8800 and fund = 0455\")\n\n#tollway debt principal and interest\n\ntollwaydebt <- exp_temp %>%filter(object == \"8800\" & fund == \"0455\") %>% group_by(fy) %>% summarize(sum=sum(expenditure)) \n\n# Tollway agency expenditures = SAME as filtering by fund == 0455\n\n#tollway<-exp_temp %>% filter(agency == \"557\")\n\n#exp_temp %>% filter(agency == \"557\") %>% group_by(fy) %>% summarize(sum = sum(expenditure)) %>% arrange(-fy)\n\n# contributions and benefits paid comparison\n\nggplot()+\n\n  geom_line(data=tollway_bondproc, aes(x=fy, y=sum, color='Bond Proceeds')) +\n\n  geom_line(data= tollwaydebt, aes(x=fy, y = sum, color = 'Debt Service'))+ \n\n  geom_line(data= tollway_exp, aes(x=fy, y = expenditure, color = 'Tollway Expenditures'))+ \n\n  geom_line(data= alltollway, aes(x=fy, y = sum, color = \"Tollway Revenue\"))+ \n\n  scale_color_manual(values = c(\n\n    'Bond Proceeds' = 'darkblue',\n\n    'Debt Service' = 'red',\n\n    'Tollway Expenditures' = 'orange',\n\n    'Tollway Revenue' = 'light green')) +\n\n  labs(title=\"Tollway bond procreeds, debt service, revenue, and expenditures.\", \n\n       caption = \"Tollway revenue + bond proceeds should be roughly equal to tollway expenditures + debt service.\", \n\n       y = \"Dollars\")\n\n\n\n2.0.0.2 State Principal and Interest\nFiltering for interest on short term borrowing and GO bonds (88130008, 88130000, and 88130108) and GO bond principal amounts (88110008).\n- object == 8813 is for all debt service interest but obj_seq_type is used to specify short term borrowing versus regular debt service.\n- an Interest to Principal ratio is also calculated in the table below.\nLooking only at general obligation principal payments and interest payments:\n\n# GO bond principal and GO bond interest\n\nGObond_debt <- exp_temp %>% \n\n  filter(obj_seq_type == \"88110008\" |obj_seq_type == \"88130000\" | obj_seq_type == \"88130008\") %>% \n\n  group_by(fy, obj_seq_type) %>% \n\n  summarize(sum = sum(expenditure, na.rm=TRUE)) %>% \n\n  pivot_wider(names_from = obj_seq_type, values_from = sum) %>% \n\n  mutate(principal = `88110008`,\n\n         interest = sum(`88130008`+`88130000`, na.rm = TRUE),\n\n         ratio = (as.numeric(interest)/as.numeric(principal)))\n\nGObond_debt %>% select(principal, interest, ratio) %>%\n\n  mutate(across(principal:interest, ~format(., big.mark= \",\", scientific = F)))\n\n# GObond_debt %>% ggplot() + \n\n#   geom_line(aes(x=fy, y=principal, color = \"Principal\"))+ \n\n#   geom_line(aes(x=fy, y=interest, color = \"Interest\")) + \n\n#   labs(title = \"General Obligation principal and interest payments\")\n\nGObond_debt %>% ggplot() +   \n\n  geom_col(aes(x=fy, y=interest/1000000, fill = \"Interest\")) + \n\n  geom_col(aes(x=fy, y=principal/1000000, fill = \"Principal\"))+ \n\n  labs(title = \"Debt Service\", subtitle = \"General Obligation Principal and Interest Payments\")\n\nLooking only at short term borrowing principal and interest payments\n\n# short term borrowing, first observation is in 2004?\n\nshort_debt <- exp_temp %>% \n\n  filter(obj_seq_type == 88110108 |obj_seq_type == 88130108) %>% \n\n  group_by(fy, obj_seq_type) %>% \n\n  summarize(sum = sum(expenditure, na.rm=TRUE)) %>% \n\n  pivot_wider(names_from = obj_seq_type, values_from = sum) %>% \n\n  mutate(principal = `88110108`,\n\n         interest = `88130108`,\n\n         ratio = (as.numeric(interest)/as.numeric(principal)))\n\nshort_debt %>% select(principal, interest, ratio) %>%\n\n  mutate(across(principal:interest, ~format(., big.mark= \",\",  scientific = F)))\n\nshort_debt %>% ggplot() + \n\n  geom_col(aes(x=fy, y=principal/1000000, fill = \"Principal\"))+ \n\n  geom_col(aes(x=fy, y=interest/1000000, fill = \"Interest\")) + \n\n  labs(title = \"Debt Service\", subtitle = \"Short Term Borrowing: Principal and Interest Payments\")\n\nWhen including short term borrowing and normal debt service, the debt ratio seems more normal and the total interest and principal payments over the years are smoothed out.\nPrincipal and interest amounts calculated exclude the Illinois Tollway debt service and debt for capital projects. Capital projects debt service is examined below:\n\ncapitalprojects <- exp_temp %>%filter(object == \"8800\")\n\nall_debt <- exp_temp %>% \n\n  filter(fund != \"0455\" & (object == \"8811\" |object == \"8813\" | object == \"8800\") )%>% \n\n  group_by(fy, object) %>% \n\n  summarize(sum = sum(expenditure, na.rm=TRUE)) %>% \n\n  pivot_wider(names_from = object, values_from = sum) %>% \n\n  mutate(principal = `8811`,\n\n         interest = `8813`,\n\n         CapitalProjects = `8800`,\n\n         ratio = (as.numeric(interest)/as.numeric(principal)))\n\nall_debt %>% select(principal, interest, CapitalProjects, ratio) %>%\n\n  mutate(across(principal:CapitalProjects, ~format(., big.mark= \",\", scientific = F)))\n\nall_debt %>% ggplot() + \n\n  geom_line(aes(x=fy, y=principal/1000000, color = \"Principal\"))+ \n\n  geom_line(aes(x=fy, y=interest/1000000, color = \"Interest\"))+\n\n  geom_line(aes(x=fy, y = CapitalProjects / 1000000, color = \"Capital Projects\"))+\n\n  labs(y = \"Debt ($Millions)\",\n\n       title = \"Principal and Interest payments\", subtitle = \"Principal and interest from short term borrowing and GO Bonds debt service\", caption = \"Capital projects does not include Illinois tollway debt service.\n\n       Capital projects include interest and principal values as one value and cannot be sepearated.\")\n\nall_debt %>% ggplot() + \n\n  geom_line(aes(x=fy, y=principal/1000000, color = \"Principal\"))+ \n\n  geom_line(aes(x=fy, y=interest/1000000, color = \"Interest\"))+\n\n  geom_line(aes(x=fy, y = CapitalProjects / 1000000, color = \"Capital Projects Debt Service\"))+\n\n  geom_line(data = tollwaydebt, aes( x=fy, y=sum/1000000, color = \"Tollway Debt Service\"))+\n\n  labs(y = \"Debt ($Millions)\", title = \"Short term borrowing and GO Bonds\",\n\n       subtitle = \"Principal and Interest payments\", caption = \"Capital projects does not include Illinois tollway debt service.\") \n\nall_debt %>% ggplot() + \n\n  geom_line(aes(x=fy, y=(principal+interest)/1000000, color = \"Principal & Interest\"))+ \n\n  #geom_line(aes(x=fy, y=interest/1000000, color = \"Interest\"))+\n\n  geom_line(aes(x=fy, y = CapitalProjects / 1000000, color = \"Capital Projects Debt Service\"))+\n\n  geom_line(data = tollwaydebt, aes( x=fy, y=sum/1000000, color = \"Tollway Debt Service\"))+\n\n  labs(y = \"Debt ($Millions)\", title = \"Illinois Debt Service Expenditures: Short term borrowing and GO Bonds\",\n\n       subtitle = \"Principal and Interest payments\", caption = \"Capital projects does not include Illinois tollway debt service.\") \n\nCapital projects include the IL Civic Center and Build Illinois Bonds. Tollway principal and interest has been dropped from the State’s Debt Service expenditure but is counted in the Illinois Tollway Expenditure cost."
  },
  {
    "objectID": "index.html#inspecting-new-fy22-data-files",
    "href": "index.html#inspecting-new-fy22-data-files",
    "title": "Fiscal-Future-Topics",
    "section": "Inspecting new FY22 data files",
    "text": "Inspecting new FY22 data files\nData files for closed years have been obtained from IOC. The numbers of funds, agencies, organizations, and revenue sources below were found by using pivot tables in the codebook files in the FY2022 Box folder. This could also be done using R and grouping new files by fund, agency, source number, source names, etc..\nRevenue File:\n\n684 Fund Numbers\n80 Agencies\n1184 Revenue source numbers\n1156 revenue source names\n\nExpenditure File:\n\n708 Fund Numbers\n107 Agencies\n98 Organization Numbers\n313 Organization names\n\n\nFinding new agencies and funds\nGeneral steps:\n1. Identify new and reused funds for newest fiscal year.\n2. Recode funds to take into account different fund numbers/names over the years. See [Recoding New and Reused Funds] for code chunk that does this.\n3. Update fund_ab_in_2022.xlsx with any changes from previous fiscal year.\nNew Agencies, Funds, and Organizations from Expenditure files:\n\nUsing the code below, I found 2 agencies, multiple funds, and a couple organizations that had not been specifically mentioned in the funds_ab_in file - AWM, FY2022.\nNote: One new org name and org number combo has an expenditure of $600 million for pensions payment. Investigate later.\n\n\nallrevfiles22 <- read_csv(\"allrevfiles22.csv\") #combined but not recoded\n\nallexpfiles22 <- read_csv(\"allexpfiles22.csv\") #combined but not recoded\n\n\n#### From Expenditure Data #####\n\n# agencies referenced in any year before 2020:\n\nagencies_past <- allexpfiles22 %>% filter(fy < 2022) %>% mutate(agency == as.character(agency)) %>% group_by(agency, agency_name) %>% unique() %>% summarize(expenditure = sum(expenditure, na.rm = TRUE)) %>% drop_na() %>% arrange(agency)\n\n# agencies_past # 146 agencies ever\n\n# agencies in 2022 data:\n\nagencies22 <- allexpfiles22  %>% filter(fy == 2022) %>% mutate(agency == as.character(agency)) %>% group_by(agency, agency_name) %>% summarize(expenditure = sum(expenditure, na.rm = TRUE))\n\n# agencies22 # 107 agencies this year\n\n# 280 and 533 are new agency codes: \n\nanti_join(agencies22, agencies_past, by = c(\"agency\", \"agency_name\")) %>% arrange(agency)\n\n# A tibble: 2 x 3\n# Groups:   agency [2]\n  agency agency_name                expenditure\n   <dbl> <chr>                            <dbl>\n1    280 COURTS COMMISSION               37747.\n2    533 COMM ON EQUITY & INCLUSION    1405788.\n\nfunds_past <- allexpfiles22  %>% filter(fy < 2022) %>% mutate(fund == as.character(fund)) %>% group_by(fund, fund_name) %>% summarize(count = n(), Expenditure = sum(expenditure, na.rm = TRUE))  %>% drop_na()\n\nfunds22 <- allexpfiles22  %>% filter(fy == 2022) %>% mutate(fund == as.character(fund)) %>% group_by(fund, fund_name) %>%  summarize(count = n(), Expenditure = sum(expenditure, na.rm = TRUE)) %>% unique()\n\n# 15 funds were in FY22 data that were not in past data:\n\nanti_join(funds22, funds_past, by = c(\"fund\", \"fund_name\")) %>% arrange(fund)\n\n# A tibble: 15 x 4\n# Groups:   fund [15]\n   fund  fund_name                      count Expenditure\n   <chr> <chr>                          <int>       <dbl>\n 1 0110  DEV. DISABILITIES AWARENESS        1          0 \n 2 0319  PENSION STABILIZATION             10  300000000 \n 3 0351  FREEDOM SCHOOLS                    1     335306 \n 4 0367  CAP FACILITY TEC MODERNIZATION     2    1000000 \n 5 0392  EQUAL PAY REGISTRATION             1          0 \n 6 0393  SICKLE CELL CHRONIC DISEASE        1          0 \n 7 0422  ELECTRIC VEHICLE REBATE            3     225069.\n 8 0427  ENERGY TRANSITION ASSISTANCE       8    6046483.\n 9 0461  PARITY ADVANCEMENT                 1          0 \n10 0544  DOIT SPECIAL PROJECTS              3    9998632.\n11 0628  ESSENTIAL GOVT SERV SUPPORT        1  736120867.\n12 0634  STATE TREASURER'S CAPITAL          1     250000 \n13 0656  HORSE RACING PURSE EQUITY          1    5908048.\n14 0672  CONSUMER INTERVENOR COMP.          1       2665 \n15 0976  FAIRGROUNDS IMPROVMNT & RACING     1      10000 \n\n# orgs_pastin the past =  916 org groups ever\n\norgs_past <- allexpfiles22  %>% filter(fy < 2022) %>% mutate(appr_org == as.character(appr_org)) %>% group_by(appr_org, org_name) %>% unique() %>% summarize(Expenditure = sum(expenditure, na.rm = TRUE)) %>% drop_na()\n\n# orgs_past # 916 org groups ever\n\norgs22 <- allexpfiles22  %>% filter(fy == 2022) %>% mutate(appr_org = as.character(appr_org)) %>% group_by(appr_org, org_name) %>% summarize(Expenditure = sum(expenditure, na.rm = TRUE))\n\n# orgs22 # 396 org groups this year\n\n# 4 org number and org name combos are new for FY2022:\n\nanti_join(orgs22, orgs_past, by = c(\"appr_org\", \"org_name\")) %>% arrange(appr_org)\n\n# A tibble: 4 x 3\n# Groups:   appr_org [4]\n  appr_org org_name                      Expenditure\n  <chr>    <chr>                               <dbl>\n1 05       PAROLE                          53426135.\n2 06       RE-ENTRY SERVICES               18338411.\n3 25       RETIREMENT SYSTEM PMT ADMIN    600000000 \n4 34       IL CRIMINAL JUSTICE INFO AUTH      55659.\n\n\nNew Revenue Funds, Sources, and New Agencies:\n\n#### From Revenue Data ####\n\n# agencies_past # 108 agencies ever\n\nagencies_past <- allrevfiles22  %>% filter(fy < 2022) %>% mutate(agency == as.character(agency)) %>% group_by(agency, agency_name) %>% unique() %>% summarize(Receipts = sum(receipts, na.rm = TRUE)) %>% drop_na()\n\n# agencies22 # 80 agencies this year\n\nagencies22 <- allrevfiles22  %>% filter(fy == 2022) %>% mutate(agency == as.character(agency)) %>% group_by(agency, agency_name) %>% summarize(Receipts = sum(receipts, na.rm = TRUE))\n\n# 0 new agencies in revenue data this year\n\nanti_join(agencies22, agencies_past, by = c(\"agency\", \"agency_name\")) %>% arrange(agency)\n\n# A tibble: 0 x 3\n# Groups:   agency [0]\n# ... with 3 variables: agency <dbl>, agency_name <chr>, Receipts <dbl>\n\nfunds_past <- allrevfiles22  %>% filter(fy < 2022) %>% mutate(fund == as.character(fund)) %>% group_by(fund, fund_name) %>% summarize(count = n(), Receipts = sum(receipts, na.rm = TRUE))  %>% drop_na()\n\nfunds22 <- allrevfiles22  %>% filter(fy == 2022) %>% mutate(fund == as.character(fund)) %>% group_by(fund, fund_name) %>%  summarize(count = n(), Receipts = sum(receipts, na.rm = TRUE)) %>% unique() %>% drop_na()\n\n# 19 revenue funds were in FY22 revenue data that were not in past data \n\n# some could be small fund name changes\n\nanti_join(funds22, funds_past, by = c(\"fund\", \"fund_name\")) %>% arrange(fund)\n\n# A tibble: 19 x 4\n# Groups:   fund [19]\n   fund  fund_name                      count    Receipts\n   <chr> <chr>                          <int>       <dbl>\n 1 0165  RONALD MCDONALD HOUSE CHARITY      1     143893.\n 2 0319  PENSION STABILIZATION              1  300000000 \n 3 0351  FREEDOM SCHOOLS                    1   17000000 \n 4 0367  CAP FACILITY TEC MODERNIZATION     1    5300000 \n 5 0392  EQUAL PAY REGISTRATION             1      24150 \n 6 0422  ELECTRIC VEHICLE REBATE            3   13528800 \n 7 0427  ENERGY TRANSITION ASSISTANCE       1   28773075.\n 8 0544  DOIT SPECIAL PROJECTS              2    9998632.\n 9 0628  ESSENTIAL GOVT SERV SUPPORT        1 1000000000 \n10 0634  STATE TREASURER'S CAPITAL          2     273192.\n11 0656  HORSE RACING PURSE EQUITY          1    5908048.\n12 0672  CONSUMER INTERVENOR COMP.          1    1220000 \n13 0683  GROCERY TAX REPLACEMENT            1  325000000 \n14 0723  REVOCATION ENFORCEMENT             1     749073.\n15 0742  ST. POLICE TRAINING & ACADEMY      1    2803359.\n16 0743  LAW ENFORCEMENT TRAINING           1   25230230.\n17 0848  SETTLEMENT                         1    5000000 \n18 0966  ILLINOIS WORKS                     1   10000000 \n19 0976  FAIRGROUNDS IMPROVMNT & RACING     3      93664.\n\nsources_past <- allrevfiles22  %>% filter(fy < 2022) %>% mutate(source == as.character(source)) %>% group_by(source, source_name) %>% summarize(count = n(), Receipts = sum(receipts, na.rm = TRUE))  %>% drop_na()\n\nsources22 <- allrevfiles22  %>% filter(fy == 2022) %>% mutate(source == as.character(source)) %>% group_by(source, source_name) %>%  summarize(count = n(), Receipts = sum(receipts, na.rm = TRUE)) %>% unique()\n\n# 20 revenue sources were in FY22 data that were not in past data \n\n# some could be small source name changes:\n\nanti_join(sources22, sources_past, by = c(\"source\", \"source_name\")) %>% arrange(source)\n\n# A tibble: 20 x 4\n# Groups:   source [20]\n   source source_name                    count   Receipts\n   <chr>  <chr>                          <int>      <dbl>\n 1 0303   LOTTERY-ILOTTERY SETTLEMENT        1 177417302.\n 2 2292   VIDEO TERMINAL TAX                 3 893824162.\n 3 2457   E ST LOUIS FINANCE AUTH            1     41667.\n 4 2590   ALTON CENTER BUSINESS PARK         1    291667.\n 5 2611   E-PAY ADMINISTRATION FEES          1   1136121.\n 6 2660   CONCESSION REVENUE-FOOD            1     17210.\n 7 2682   SW BADGE REPLACEMENT FEES          1        10 \n 8 2699   RB RECONCILIATION FEE              1  15000000 \n 9 2729   NORTH PARK COLLEGE LIC PLATES      1        20 \n10 2736   STATE ST INSTITNL US GOV FND       1   1622448.\n11 2737   VGA - IL STATE FAIR OP FEES        1     48387.\n12 2738   VGA-DU QUOIN STATE FAIR OP FEE     1     11029.\n13 2739   PUBLIC UTILITIES                   1   1220000 \n14 2740   ENRGY TRANSITION ASST/ELECTRIC     1  28773075.\n15 2742   OPERATION ASSESSMENT FEE           1   2828085.\n16 2745   FY22 TITLE INCREASE                1   3072054 \n17 2747   BUSINESS FILING FEE                1     24150 \n18 2748   CORN COMMODITY SPONSORS            1      5000 \n19 2755   PUBLIC UTIL - ETHICS REPRT FEE     1   1235000 \n20 2756   UNEXP CAPITAL IMP PROJECTS         1     90583.\n\n\nSources 2737 through 2756 were not found in the IOC_source file so I added them to `ioc_source_updated22_AWM.xlsx`. They do NOT have a rev_type until the Fiscal Futures researchers discuss which revenue type the sources fall under and if they should be included in the analysis in general.\n\n\nRecoding New and Reused Funds\nNew funds will need to be manually added to the funds_ab_in excel file and determined if they should or should not be included in Fiscal Future calculations.\nFor funds that were reused once, a 9 replaces the 0 as the first digit. If reused twice, then the first two values are 10.\n- Ex. 0350 --> 9350 because its use changed.\n- Ex. 0367 becomes 10367 because its use has changed twice now. There was fund 0367 originally, then its use changed and it was recoded as 9367, and now it changed again so it is a 10367.\n- Excel file also has alternative ways to name funds (e.g. 0397-A and 0397-B) and variables for the year that the fund stopped being used. These have not been updated consistently over the years but it is useful information when trying to find any coding mistakes from the past.\nNew or reused funds revenue file recoding:\n\n# if first character is a 0, replace with a 9 if its purpose has changed\n\nrev_1998_2022 <- allrevfiles22 %>%\n\n      mutate(fund = ifelse(fy < 2002 & fund %in% c(\"0730\", \"0241\", \"0350\", \"0367\", \"0381\", \"0382\", \"0526\", \"0603\", \"0734\", \"0913\", \"0379\"), str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund = ifelse (fy < 2008 & fund %in% c(\"0027\", \"0033\", \"0037\", \"0058\", \"0062\", \"0066\", \"0075\", \"0083\", \"0116\", \"0119\", \"0120\", \"0122\", \"0148\", \"0149\", \"0157\", \"0158\", \"0166\", \"0194\", \"0201\", \"0209\", \"0211\", \"0217\", \"0223\", \"0231\", \"0234\", \"0253\", \"0320\", \"0503\", \"0505\", \"0512\", \"0516\", \"0531\", \"0532\", \"0533\", \"0547\", \"0563\", \"0579\", \"0591\", \"0606\", \"0616\", \"0624\", \"0659\", \"0662\", \"0665\", \"0676\", \"0710\", \n\n\"0068\", \"0076\", \"0115\", \"0119\", \"0168\", \"0182\", \"0199\", \"0241\", \"0307\", \"0506\", \"0509\", \"0513\"), str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund = ifelse(fy < 2016 & fund %in% c(\"0263\", \"0399\", \"0409\"), str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund =  ifelse(fy < 2017 & fund == \"0364\", str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund =  ifelse(fy < 2018 & fund %in% c(\"0818\", \"0767\", \"0671\", \"0593\", \"0578\"), str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund = ifelse(fy>1999 & fy < 2018 & fund == \"0231\", \"10231\", fund) ) %>%\n\n  \n\n  mutate(fund = ifelse(fy < 2019 & fund %in% c(\"0161\", \"0489\", \"0500\", \"0612\", \"0893\", \"0766\"), str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund =  ifelse(fy < 2020 & fund %in% c(\"0254\", \"0304\", \"0324\", \"0610\", \"0887\", \"0908\", \"0939\", \"0968\"), str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund =  ifelse(fy < 2021 & fund %in% c(\"0255\", \"0325\", \"0348\", \"0967\", \"0972\"), str_replace(fund, \"0\",\"9\"), fund) ) %>%\n\n  \n\n   #2022 changes\n\n  mutate(fund = ifelse(fy < 2022 & fund %in% c(\"0110\",\"0165\",\"0351\", \"0392\", \"0393\", \"0422\", \"0544\", \"0628\", \"0634\",  \"0656\", \"0672\", \"0683\", \"0723\", \"0742\", \"0743\"), str_replace(fund, \"0\",\"9\"), as.character(fund))) %>%  # replaces first 0 it finds with a 9\n\n  mutate(fund = ifelse(fy < 2022 & fund == \"0367\", \"10367\", as.character(fund)) # fund reused for 3rd time\n\n)\n\nFor 2022, new funds included The Essential Government Services fund, Electric Vehicle Rebate, Budget Stabilization fund, and more. New funds were added to the funds_ab_in.xlsx file and recoded funds were addressed in the code chunks below and updated in the same excel file.\nExpenditure recoding:\n\n# if first character is a 0, replace with a 9\n\nexp_1998_2022 <- allexpfiles22 %>%\n\n      mutate(fund = ifelse(fy < 2002 & fund %in% c(\"0730\", \"0241\", \"0350\", \"0367\", \"0381\", \"0382\", \"0526\", \"0603\", \"0734\", \"0913\", \"0379\"), str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund = ifelse(fy < 2008 & fund %in% c(\"0027\", \"0033\", \"0037\", \"0058\", \"0062\", \"0066\", \"0075\", \"0083\", \"0116\", \"0119\", \"0120\", \"0122\", \"0148\", \"0149\", \"0157\", \"0158\", \"0166\", \"0194\", \"0201\", \"0209\", \"0211\", \"0217\", \"0223\", \"0231\", \"0234\", \"0253\", \"0320\", \"0503\", \"0505\", \"0512\", \"0516\", \"0531\", \"0532\", \"0533\", \"0547\", \"0563\", \"0579\", \"0591\", \"0606\", \"0616\", \"0624\", \"0659\", \"0662\", \"0665\", \"0676\", \"0710\", \n\n\"0068\", \"0076\", \"0115\", \"0119\", \"0168\", \"0182\", \"0199\", \"0241\", \"0307\", \"0506\", \"0509\", \"0513\"), str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund = ifelse(fy < 2016 & fund %in% c(\"0263\", \"0399\", \"0409\"), str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund =  ifelse(fy < 2017 & fund == \"0364\", str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund =  ifelse(fy < 2018 & fund %in% c(\"0818\", \"0767\", \"0671\", \"0593\", \"0578\"), str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  mutate(fund = ifelse(fy>1999 & fy < 2018 & fund == \"0231\", \"10231\", fund) ) %>%\n\n  \n\n  mutate(fund = ifelse(fy < 2019 & fund %in% c(\"0161\", \"0489\", \"0500\", \"0612\", \"0893\", \"0766\"), str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund =  ifelse(fy < 2020 & fund %in% c(\"0254\", \"0304\", \"0324\", \"0610\", \"0887\", \"0908\", \"0939\", \"0968\"), str_replace(fund, \"0\",\"9\"), fund)) %>%\n\n  \n\n  mutate(fund =  ifelse(fy < 2021 & fund %in% c(\"0255\", \"0325\", \"0348\", \"0967\", \"0972\"), str_replace(fund, \"0\",\"9\"), fund))  %>%\n\n  \n\n  #2022 changes\n\n  mutate(fund = ifelse(fy < 2022 & fund %in% c(\"0110\",\"0165\",\"0351\", \"0392\", \"0393\", \"0422\", \"0544\", \"0628\", \"0634\",  \"0656\", \"0672\", \"0683\",\"0723\", \"0742\", \"0743\"), str_replace(fund, \"0\",\"9\"), as.character(fund))) %>%  # replaces first 0 it finds with a 9\n\n  mutate(fund = ifelse(fy < 2022 & fund == \"0367\", \"10367\", as.character(fund)) # fund reused for 3rd time \n\n  )\n\nThe `funds_ab_in.xlsx` file contains all funds that have existed since 1998, if they still exist, indicates if fund numbers have been reused for varying purposes, and is updated yearly with new fund numbers used by the IOC.\n\nfunds_ab_in_2022 = readxl::read_excel(\"C:/Users/aleaw/OneDrive/Documents/PhD Fall 2021 - Spring 2022/Merriman RA/Fiscal Futures FY2022/Replication-Files/funds_ab_in_2022.xlsx\")\n\nexp_temp <- exp_1998_2022 %>% \n\n  arrange(fund, fy) %>%\n\n  filter(expenditure != 0) %>%             # keeps everything that is not zero\n\n# join  funds_ab_in_2021  to exp_temp\n\n left_join(funds_ab_in_2022, by = \"fund\")  # matches most recent fund number \n\n# Agency == 799 for Statutory transfers \n\n#  Object == 1993 is for Interfund cash transfers  \n\nexp_temp <- exp_temp %>% \n\n  mutate(transfer = ifelse(org_name == \"TRANSFERS\", 1, 0),\n\n         trans_agency = ifelse(org_name == \"TRANSFERS\", str_sub(obj_seq_type,1,3), trans_agency),\n\n         trans_type = ifelse(org_name == \"TRANSFERS\", str_sub(obj_seq_type,4,9), trans_type)\n\n         )\n\n- the initial combined years of data are saved as dataframes named `exp_1998_2022` and `rev_1998_2022`. These are then saved as exp_temp and rev_temp while recoding variables. This is BEFORE category groups are created and cleaned below. `exp_temp` and `rev_temp` are only temporary files; do not use for aggregating totals yet!\nUpdate Agencies: Some agencies have merged with others or changed names over time.\n\n# recodes old agency numbers to consistent agency number\n\nexp_temp <- exp_temp %>% \n\n  mutate(agency = case_when(\n\n    (agency==\"438\"| agency==\"475\" |agency == \"505\") ~ \"440\",\n\n    # financial institution &  professional regulation &\n\n     # banks and real estate  --> coded as  financial and professional reg\n\n    agency == \"473\" ~ \"588\", # nuclear safety moved into IEMA\n\n    (agency ==\"531\" | agency ==\"577\") ~ \"532\", # coded as EPA\n\n    (agency ==\"556\" | agency == \"538\") ~ \"406\", # coded as agriculture\n\n    agency == \"560\" ~ \"592\", # IL finance authority (fire trucks and agriculture stuff)to state fire marshal\n\n    agency == \"570\" & fund == \"0011\" ~ \"494\",   # city of Chicago road fund to transportation\n\n    TRUE ~ (as.character(agency)))) \n\nFor aggregating revenue, use the rev_1998_2022 dataframe, join the funds_ab_in_2022 file to it, and then join the ioc_source_type file to the dataset. Remember: You need to update the funds_ab_in and ioc_source_type file every year!\n\n# fund info to revenue for all years\n\nrev_temp <- inner_join(rev_1998_2022, funds_ab_in_2022, by = \"fund\") %>% arrange(source)\n\n# need to update the ioc_source_type file every year! \n\nioc_source_type <- readxl::read_xlsx(\"C:/Users/aleaw/OneDrive/Documents/PhD Fall 2021 - Spring 2022/Merriman RA/Fiscal Futures FY2022/Replication-Files/ioc_source_updated22_AWM.xlsx\")\n\nrev_temp <- left_join(rev_temp, ioc_source_type, by = \"source\")\n\n# automatically used source, source name does not match for the join to work using source_name\n\n# recodes old agency numbers to consistent agency number\n\nrev_temp <- rev_temp %>% \n\n  mutate(agency = case_when(\n\n    (agency==\"438\"| agency==\"475\" |agency == \"505\") ~ \"440\",\n\n    # financial institution &  professional regulation &\n\n     # banks and real estate  --> coded as  financial and professional reg\n\n    agency == \"473\" ~ \"588\", # nuclear safety moved into IEMA\n\n    (agency ==\"531\" | agency ==\"577\") ~ \"532\", # coded as EPA\n\n    (agency ==\"556\" | agency == \"538\") ~ \"406\", # coded as agriculture\n\n    agency == \"560\" ~ \"592\", # IL finance authority (fire trucks and agriculture stuff)to state fire marshal\n\n    agency == \"570\" & fund == \"0011\" ~ \"494\",   # city of Chicago road fund to transportation\n\n    TRUE ~ (as.character(agency))))"
  },
  {
    "objectID": "Medicaid.html#federal-medicaid-reimbursements-and-medicaid-costs",
    "href": "Medicaid.html#federal-medicaid-reimbursements-and-medicaid-costs",
    "title": "1  Medicaid",
    "section": "1.1 Federal Medicaid Reimbursements and Medicaid Costs",
    "text": "1.1 Federal Medicaid Reimbursements and Medicaid Costs\n\nmedicaid_cost <- exp_temp %>% filter(agency==\"478\" & (appr_org==\"01\" | appr_org == \"65\" | appr_org==\"88\") & (object==\"4900\" | object==\"4400\")) %>% group_by(fy) %>% summarize(sum=sum(expenditure))\n\nmed_reimburse <- rev_temp %>% filter(rev_type==\"57\" & agency==\"478\" & (source==\"0618\"|source==\"2364\"|source==\"0660\"|source==\"1552\"| source==\"2306\"| source==\"2076\"|source==\"0676\"|source==\"0692\")) %>% group_by(fy) %>% summarize(sum=sum(receipts))\n\nggplot()+\n\n  geom_line(data=medicaid_cost, aes(x=fy, y=sum), color = \"red\") + \n\n  geom_line(data=med_reimburse, aes(x=fy, y = sum), color=\"black\") + labs(title = \"Medicaid reimbursements and Medicaid expenditures\", caption = \"Medicaid expenditures include funds provided to medical providers. \")"
  },
  {
    "objectID": "Healthcare.html",
    "href": "Healthcare.html",
    "title": "4  State Employee Healthcare Discussion",
    "section": "",
    "text": "library(tidyverse)\nlibrary(haven)\nlibrary(formatR)\nlibrary(lubridate)\nlibrary(smooth)\nlibrary(forecast)\nlibrary(scales)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(quantmod)\nlibrary(geofacet)\nlibrary(janitor)\n\n\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, cache = TRUE, eval=FALSE)\n\nState Employee Health Care = Sum of expenditures for “health care coverage as elected by members per state employees group insurance act.” The payments are made from the Health Insurance Reserve Fund. Employee contributions are not considered a revenue source or an expenditure in our analysis.\nFunding for the State Employees Group Insurance plan originates from two funds. The Health Insurance Reserve Fund (HIRF) and the Group Insurance Premium Fund (GIPF). Contributions and payment for Health coverage benefits are deposited INTO HIRF and contributions for life insurance are deposited into the GIPF.\nHIRF is the fund mainly used to administer the group insurance program. Funding for HIRF comes from several different revenue sources, the General Revenue Fund (GRF), Road Fund, reimbursements, university funds, and misc funds. CGFA Report.\nCoding details\nIn FY2013, the Local Government Health Insurance fund was transferred to the department of Central Management Services (agency changes from 478 to 416 in data.)\nEmployer group insurance contributions for health insurance are excluded to avoid double counting the cost of healthcare provision. All employer group insurance contributions are coded as object = 1180. BUT the last two fiscal years were coded as 1900 instead of 1180 for lump sums instead of employer contributions\n- anything to do with pandemic money categorization?\nFund = 0907 = health insurance reserve, in_ff = 1\nFund = 0457 is “Group insurance premium”, in_ff = 1\nFund = 0193 is “Local govt health insurance reserve”, in=ff = 0\nfund = 0477 is “Community College Health Insurance”, in=ff = 0.\n- had large amount in early years\nFund = 9939 is “group self-insurers’ insolv”, in_ff = 1\nFund = 0940 is Self-Insurers security, in_ff = 0\nFund = 0739 is Group Workers Comp Pool Insol, in_ff = 1\n- eehc = 0 means it is NOT a state healthcare cost but it is an employer contribution of some type to some fund\n- eehc = 1 means it is a state employee healthcare cost and it is an employer contribution to health insurance\n\nhealth_ins_reserve <- exp_temp %>% filter(fund == \"0907\") %>%  group_by(fy) %>% \n\n    summarize(fund_0907 = sum(expenditure)) \n\nhealth_ins_reserve %>% \n\n  ggplot(aes(x=fy, y=fund_0907)) + geom_line() + labs(title=\"Health Insurance Reserve\", subtitle = \"Sum of expenditures from fund 907\")\n\n# object 1180 is inconsistently coded over time form the IOC \n\n# object 1180 should be employer contributions to healthcare group insurance\n\nemployer_contributions <- exp_temp %>% filter(object == \"1180\") %>% group_by(fy) %>% summarize(object1180 = sum(expenditure)) \n\nemployer_contributions%>% \n\n  ggplot(aes(x=fy, y=object1180)) + geom_line() + labs(title=\"Employer Contributions to Healthcare Group Insurance, IOC Object 1180\")\n\nemployer_contributions2 <- exp_temp %>% filter(object == \"1180\" & fund==\"0001\") %>% group_by(fy) %>% summarize(object1180 = sum(expenditure)) \n\nemployer_contributions2 %>% \n\n  ggplot(aes(x=fy, y=object1180)) + geom_line() + labs(title=\"Employer Contributions to Healthcare Group Insurance\", subtitle = \"IOC Object 1180 from Fund 001\")\n\n# examine combined group insurance totals per year\n\ngroup_ins2 <- exp_temp %>% \n\n  mutate(eehc = ifelse(\n\n    # group insurance contributions for 1998-2005 and 2013-present\n\n    # CMS took over health insurance in 2013\n\n   fund == \"0001\" & (object == \"1180\" | object ==\"1900\") & agency == \"416\" & appr_org==\"20\", 1, 0) )%>% \n\n  mutate(eehc = ifelse(\n\n    # group insurance contributions for 2006-2012\n\n    # health insurance was in healthcare and family services, agency 478 for a few years\n\n    fund == \"0001\" & object == \"1180\" & agency == \"478\" & appr_org==\"80\", 1, eehc) )%>%\n\n  filter(eehc == 1) %>% \n\n    group_by(fy) %>% \n\n    summarize(dropped_group_premiums = sum(expenditure, na.rm=TRUE))\n\ngroup_ins2 %>% ggplot(aes(x=fy, y=dropped_group_premiums)) + geom_line() + labs(title=\"Employer Healthcare Group Insurance Contributions\", subtitle= \" - Dropped from analysis to avoid double counting healthcare expenditures\", caption = \"Objects 1180 and 1900 from fund 0001. See code for additional coding details.\")\n\nIf observation is a group insurance contribution, then the expenditure amount is set to $0 (essentially dropped from analysis).\n\n4.0.1 Health Insurance Premiums - Revenue Side\nEmployee insurance premiums for healthcare are a revenue source for the state in the IOC data but are NOT included in the Fiscal Futures analysis and fiscal gap calculations.\nSource #’s:\n0120 = ins prem-option life\n0120 = ins prem-optional life/univ\n0347 = optional health - HMO\n0348 = optional health - dental\n0349 = optional health - univ/local SI\n0350 = optional health - univ/local\n0351 = optional health - retirement\n0352 = optional health - retirement SI\n0353 = optional health - retire/dental\n0354 = optional health - retirement hmo\n2199-2209 = various HMOs, dental, health plans from Health Insurance Reserve (fund)\n\nhealth_insurance_fund_rev<- rev_temp %>% \n\n  filter(fund==\"0907\") %>% \n\n    group_by(fy) %>%\n\n  summarize(health_ins_rev = sum(receipts)) \n\nhealth_insurance_fund_rev %>% \n\n  ggplot(aes(x=fy, y = health_ins_rev)) + \n\n  geom_line() + labs( title = \"Health insurance fund - All revenue, Fund 0907\")\n\n#collect optional insurance premiums to fund 0907 for use in eehc expenditure  \n\nemployee_health_premiums <- rev_temp %>% \n\n  mutate(employee_premiums = ifelse(\n\n    fund==\"0907\" & (source==\"0120\"| source==\"0121\"| (source>\"0345\" & source<\"0357\")|(source>\"2199\" & source<\"2209\")), 1, 0)) %>%\n\n  filter(employee_premiums == 1)\n\n# optional insurance premiums = employee insurance premiums\n\nemp_premium <- employee_health_premiums %>%\n\n  group_by(fy) %>%\n\n  summarize(employee_premiums_sum = sum(receipts))\n\n  \n\nemp_premium %>% ggplot(aes(x=fy, y = employee_premiums_sum)) + \n\n  geom_line() + labs( title = \"Employee health insurance premiums\")\n\n# contributions and benefits paid comparison\n\nggplot()+\n\n  #  geom_line(data=group_ins, aes(x=fy, y=object1180, color='Group Insurance1')) +\n\n      geom_line(data=health_insurance_fund_rev, aes(x=fy, y=health_ins_rev, color='Health Insurance Fund - All Revenue')) +\n\n geom_line(data = emp_premium, aes(x=fy, y = employee_premiums_sum, color = 'Revenue from Employee Premiums')) +\n\n    geom_line(data=health_ins_reserve, aes(x=fy, y=fund_0907, color='Cost of Provision')) +\n\n    geom_line(data=employer_contributions, aes(x=fy, y=object1180, color='Group Insurance-Object1180')) +\n\n #   geom_line(data=employer_contributions2, aes(x=fy, y=object1180, color='Employer Contributions-General Fund')) +\n\n  geom_line(data=group_ins2, aes(x=fy, y=dropped_group_premiums, color='Group Insurance - 1180 & 1900')) +\n\n  #geom_line(data= healthcare_costs, aes(x=fy, y = cost_of_provision, color = 'Healthcare Costs'))+ \n\n  scale_color_manual(values = c(\n\n    'Cost of Provision' = 'darkblue',\n\n    'Health Insurance Fund - All Revenue' = 'light green',\n\n    'Revenue from Employee Premiums' = 'dark green',\n\n    'Group Insurance - 1180 & 1900' = 'blue',\n\n    'Group Insurance-Object1180' = 'light blue'\n\n   #     'Employer Contributions-General Fund' = 'light blue'\n\n)) +\n\n  labs(title=\"Healthcare costs and group insurance contributions\", \n\n       caption = \"Healthcare costs and group insurance contributions\", \n\n       y = \"Dollars\", x = \"\")\n\nexp_temp <- exp_temp %>% \n\n  mutate(eehc = ifelse(object == \"1180\", 1, 0)) %>%\n\n  mutate(eehc = ifelse((eehc == 1 & in_ff ==\"0\"), 2, eehc))\n\n#%>%mutate(in_ff = ifelse(eehc == 2, \"1\", in_ff) ) %>% filter(eehc ==2 )\n\ntable(exp_temp$eehc)"
  }
]